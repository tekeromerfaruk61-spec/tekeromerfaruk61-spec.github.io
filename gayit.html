<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1.5 Adana Jet Motor Tasarım Takımı Kayıt Formu</title>
    <!-- Bootstrap 5 CSS ve JS CDN'leri -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- FingerprintJS CDN'i -->
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>

    <style>
        body {
            background-color: #f0f2f5;
        }
        .form-container {
            max-width: 600px;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body class="d-flex align-items-center justify-content-center">

<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8 form-container">
            <div class="card shadow-lg p-4">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">Kullanıcı Kayıt Formu</h2>
                    
                    <form id="kayitFormu" action="https://mskara.com.tr/omer/index.php" method="POST">
                        <input id="cihaz_id" name="cihaz_id" type="hidden">
    
                        <div class="mb-3">
                            <label for="ad_soyad" class="form-label">Ad Soyad</label>
                            <input id="ad_soyad" name="ad_soyad" type="text" class="form-control rounded-3" placeholder="Ad Soyad" required>
                        </div>
    
                        <div class="mb-3">
                            <label for="telefon_numarasi" class="form-label">Telefon Numarası</label>
                            <input id="telefon_numarasi" name="telefon_numarasi" type="phone" class="form-control rounded-3" placeholder="Telefon Numarası" required>
                        </div>
    
                        <div class="mb-3">
                            <label for="okul_kurum" class="form-label">Okul / Kurum</label>
                            <input id="okul_kurum" name="okul_kurum" type="text" class="form-control rounded-3" placeholder="Okul / Kurum">
                        </div>
    
                        <div class="mb-3">
                            <label for="sinif" class="form-label">Sınıf</label>
                            <input id="sinif" name="sinif" type="text" class="form-control rounded-3" placeholder="Sınıf">
                        </div>
    
                        <div class="mb-3">
                            <label for="aciklama" class="form-label">Açıklama</label>
                            <textarea id="aciklama" name="aciklama" rows="5" class="form-control rounded-3" placeholder="Açıklama"></textarea>
                        </div>
    
                        <button type="submit" class="btn btn-primary w-100 rounded-3 mt-3">Gönder</button>
                    </form>
    
                    <div id="mesajAlani" class="alert mt-4 d-none" role="alert"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('kayitFormu').addEventListener('submit', function(e) {
    e.preventDefault();

    // FingerprintJS ile cihaz ID'sini al
    FingerprintJS.load().then(fp => fp.get()).then(result => {
        const visitorId = result.visitorId;
        
        // Gizli input alanına ID'yi yerleştir
        document.getElementById('cihaz_id').value = visitorId;

        const form = e.target;
        const formData = new FormData(form);
        const mesajAlani = document.getElementById('mesajAlani');

        // Mesaj alanını varsayılan durumuna sıfırla
        mesajAlani.innerHTML = '';
        mesajAlani.classList.add('d-none');
        mesajAlani.classList.remove('alert-success', 'alert-danger');

        fetch(form.action, {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            mesajAlani.innerHTML = data;
            mesajAlani.classList.remove('d-none');

            if (data.includes("başarıyla kaydedildi")) {
                mesajAlani.classList.add('alert-success');
                form.reset();
            } else {
                mesajAlani.classList.add('alert-danger');
            }
        })
        .catch(error => {
            console.error('Hata:', error);
            mesajAlani.innerHTML = 'Sunucuya bağlanırken bir hata oluştu.';
            mesajAlani.classList.remove('d-none');
            mesajAlani.classList.add('alert-danger');
        });
    });
});
</script>

</body>
</html>
